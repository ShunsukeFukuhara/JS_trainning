## 問題

書籍の 15.12 の説明には以下のような説明がある。

```
本章で紹介するクライアントサイドストレージのいずれも、暗号化機能を備えていませ ん。保存したデータは、ユーザのデバイス上に暗号化されていない形式で存在します。
```

では、Web アプリケーションがユーザの機密情報をセキュアに扱うためにはどのようなことが必要になるか記述しなさい。ブラウザでの対応に限らず、Web アプリケーション全般を対象として考えること。

## 解答

Webアプリケーションにおいて、基本的にクライアント(フロントエンド)は信頼できないものとして扱う必要がある。そのため、機密情報の取り扱いはサーバがその責務を負うべきである。以下に具体的な対策を挙げる。

1. HTTPSの利用: 通信経路上での盗聴や改ざんを防ぐために、常にHTTPSを使用してデータを送受信する。
2. サーバサイドでの暗号化: 機密情報はサーバ側で暗号化して保存し、必要に応じて復号する。これにより、万が一データベースが漏洩しても情報が保護される。
3. アクセストークンの利用: 機密情報へのアクセスにはパスワードやその他固定の認証情報を直接使用せず、アクセストークンやセッションIDを利用する。これにより、機密情報自体がクライアントに送信されることを防ぐ。また、トークンは短期間で有効期限が切れるように設定する。クライアント側ではトークンはセキュアなストレージ(例: HttpOnlyクッキー)に保存し、JavaScriptから直接アクセスできないようにする。
4. クライアントがアクセス可能な情報の最小化: クライアントに送信するデータは必要最低限にとどめ、機密情報はサーバ側で処理する。
5. CORSポリシーの適切な設定: クロスオリジンリクエストを制限し、信頼できるオリジンからのみ機密情報にアクセスできるようにする。
6. セキュリティヘッダーの設定: Content Security Policy (CSP)やX-Content-Type-Optionsなどのセキュリティヘッダーを適切に設定し、XSS攻撃やその他の攻撃から保護する。また、Cookieを用いる認証ではCSRF対策としてCSRFトークンの導入やSameSite属性の設定が必要である。
