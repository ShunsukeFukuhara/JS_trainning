## 問題

1. Active や Completed を選択後にブラウザのリロードを行うとどうなるだろうか。hashchange と pushState それぞれの実装について調べなさい
   (ヒント: 開発者ツールでどのような通信が発生しているか調べてみなさい)。

2. ここまでの例は serve コマンドで HTML や JS といったファイル配信するサーバーを立ち上げてきた。
   サーバー側がどのような挙動をすれば pushState を使った実装が期待通り動作するか考えて答えなさい。

## 解答

1.  hashchangeの場合は#の後ろの部分がURLに追加されるだけなので、リロードしても同じHTMLファイル([route]/index.html)が読み込まれ、JavaScriptが再度実行されることで状態が復元される。
    一方、pushStateの場合はURLのパス部分が変更されるため、リロードするとサーバーにその新しいパスへのリクエスト([route]/active)が送信される。サーバーは(事前に設定されていない限り)そのパスに対応するファイルを持っていないため、404エラーが発生する。

2.  サーバー側で、pushStateで変更される可能性のあるすべてのパスに対して、対応するHTMLファイルを返すように
    設定されていれば、リロード時に404エラーが発生せず、JavaScriptが再度実行されて状態が復元される。
    具体的にはサーバーのルーティング設定で、以下の実装が考えられる。

    - すべてのパスに対して同じHTMLファイルを返すようにする。

      ```npm
      serve -s .
      ```

    - サーバー側でURLのパスを解析し、対応するパスが存在しない場合でも、デフォルトのHTMLファイルを返すように設定することも考えられる。

      ```javascript
      app.get("*", (req, res) => {
        res.sendFile(path.join(__dirname, "index.html"));
      });
      ```
